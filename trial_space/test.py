import numpy as np
import scipy.stats
from scipy.stats import truncnorm
import matplotlib.pyplot as plt
import matplotlib.colors as mcolors
import os
import seaborn
import sys
import argparse
sys.path.append(os.path.abspath('../'))
import pprint

import load_data_MITBIH as ld
import pandas as pd
import load_data_NAB as nab

# d_values = [260, 400, 720]
# k_values = [1,2,3,4,5]
#
# for d in d_values:
#     for k in k_values:
#         print(d, k)
#         R = np.random.normal(loc=0.0, scale=1.0, size=(k, d))
#         # print((1 / np.sqrt(d) * R) @ ((1/np.sqrt(d)) * R.T))
#         R_prime = R[:, :d-50]
#         print((1 / np.sqrt(d-50) * R_prime) @ ((1 / np.sqrt(d-50)) * R_prime.T)- np.eye(k))
#         print((1 / np.sqrt(d) * R_prime) @ ((1 / np.sqrt(d)) * R_prime.T)- np.eye(k))
# samples = []
# for root, dirs, files in os.walk("./Q_points/"):
#     for file in files:
#         if file[5:] == "dat":
#             q_points = np.genfromtxt(f'Q_points/{file}', delimiter=',')
#             record, annotation = ld.load_mit_bih_data(file[:3], 0, None)
#             diff = [q_points[i + 1] - q_points[i] for i in range(len(q_points) - 1)]
#             diff_anno = [annotation.sample[i + 1] - annotation.sample[i] for i in range(len(annotation.sample) - 1)]
#             plt.hist(diff, bins = 50)
#             plt.ylabel('Frequency')
#             plt.xlabel('Lengths')
#             plt.savefig(f"./lengths/hist_{file[:3]}", bbox_inches='tight')
#             plt.clf()


# print(max([[1],[2],[3]]))
# y1 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 0.6666666666666666, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
# x1 = [0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.001321003963011889, 0.001321003963011889, 0.001321003963011889, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.0019815059445178335, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.002642007926023778, 0.0033025099075297227, 0.003963011889035667, 0.004623513870541612, 0.004623513870541612, 0.005284015852047556, 0.005284015852047556, 0.005284015852047556, 0.0059445178335535, 0.0059445178335535, 0.0059445178335535, 0.0066050198150594455, 0.0066050198150594455, 0.007926023778071334, 0.011889035667107, 0.01453104359313078, 0.016512549537648614, 0.01915455746367239, 0.022457067371202115, 0.02774108322324967, 0.035667107001321, 0.04821664464993395, 0.0653896961690885, 0.09577278731836196, 0.13143989431968295, 0.178335535006605, 0.24108322324966974, 0.30317040951122853, 0.3579920739762219, 0.3989431968295905, 0.43262879788639363, 0.4815059445178336, 0.5237780713342141, 0.5944517833553501, 0.6968295904887715, 0.7952443857331571, 0.9042272126816381, 0.9729194187582563, 0.9966974900924703, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
#
# y = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
# x = [0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.0006605019815059445, 0.001321003963011889, 0.002642007926023778, 0.0033025099075297227, 0.0059445178335535, 0.013870541611624834, 0.02509907529722589, 0.03830911492734478, 0.059445178335535004, 0.08784676354029063, 0.12417437252311757, 0.17701453104359313, 0.23447820343461032, 0.30647291941875826, 0.3890356671070013, 0.46829590488771466, 0.5488771466314399, 0.6420079260237781, 0.7331571994715984, 0.7998678996036989, 0.8639365918097754, 0.9141347424042272, 0.9531043593130779, 0.9735799207397622, 0.9861294583883752, 0.9887714663143989, 0.9940554821664465, 0.9980184940554822, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
# plt.plot(x,y)
# plt.show()
# x = [0.853, 0.787, 0.359, 0.931, 0.802, 0.636, 0.981, 0.947, 0.760, 0.928, 0.925,0.851,0.775,0.922,0.955,0.868,0.743,0.858,0.972,0.893,0.889,0.923,0.853,0.927,0.949,0.882,0.844,0.600,0.928,0.743,0.791,0.898,0.906]
# x_avg = [0.842,0.918,0.328,0.920,0.720,0.637,0.962,0.846,0.718,0.916,0.893,0.797,0.777,0.846,0.943,0.848,0.723,0.796,0.950,0.866,0.889,0.928,0.939,0.915,0.919,0.864,0.829,0.598,0.921,0.739,0.782,0.904,0.824]
# x_beat = [0.551,0.640,0.374,0.911,0.475,0.612,0.980,0.391,0.787,0.930,0.932,0.849,0.486,0.920,0.943,0.747,0.785,0.856,0.911,0.694,0.857,0.915,0.628,0.918,0.973,0.881,0.817,0.512,0.927,0.711,0.759,0.824,0.562,]
# plt.hist(x_beat, bins = 10)
# plt.title("Histogram of AUC scores for MIT-BIH with window = beat")
# plt.xlim([0,1])
# plt.ylim([0,12])
# plt.show()

# record, annotation = ld.load_mit_bih_data('100', 0, None)
# l = len(record.p_signal)
# start = 13 - 2
# print(record.p_signal[11:13])
# print(record.p_signal[11])
# print(record.p_signal[12])
# print(record.p_signal[13])


# f = open("values.txt", "r")
# avgs = []
# maxis = []
# diffs = []
#
# for lines in f:
#     avg, maxi, diff = lines.split(" ")
#     avgs.append(float(avg.strip()))
#     maxis.append(float(maxi.strip()))
#     diffs.append(float(diff.strip()))
#
# avgs = np.array(avgs)
# maxis = np.array(maxis)
# diffs = np.array(diffs)
#
# max_wins = (np.array(avgs) > 0.55).astype(int)
# best = (maxis > diffs).astype(int)
#
# for i, v in enumerate(max_wins):
#     if v == 0 and best[i] == 0:
#         print(best[i], "max", avgs[i] - diffs[i])
    # else:
    #     print(best[i],"diff", avgs[i] - diffs[i])


# v = [0.9879314427023046, 0.8983882585989555, 0.7910240963855423, 0.7404187576326673, 0.9278995163729469, 0.7859758511480602, 0.8446651744077598, 0.8834620981152993, 0.9500707304526749, 0.9268642947314952, 0.8522628372497825, 0.922580196626916, 0.8887295558483839, 0.8942190669371197, 0.9726992514310875, 0.8576760453377328, 0.7418888738712646, 0.8674522135462671, 0.9551733410351662, 0.9230109998530555, 0.7735296010296011, 0.8507721440010809, 0.9254287770480303, 0.9274361367101245, 0.7601523801428889, 0.9468732366723094, 0.981324727174087, 0.7248496443373806, 0.8883095882141684, 0.9314016680118375, 0.600480805173445, 0.9205891234141703, 0.8569252908022544]
# plt.hist(v)
# plt.title("Distribution of AUC score new method")
# plt.show()

########## Machine Temp Fixed ##########
# rp_1_prev =[0.8631756756756757, 0.8631756756756757, 0.8581081081081081, 0.8648648648648648, 0.8631756756756757, 0.8631756756756758, 0.866554054054054, 0.8682432432432432, 0.8817567567567568, 0.8766891891891893, 0.875, 0.8699324324324325, 0.8783783783783783, 0.8716216216216217, 0.8969594594594595, 0.9138513513513513, 0.9155405405405406, 0.9189189189189189, 0.9222972972972974, 0.9273648648648649, 0.929054054054054, 0.9324324324324325, 0.9375, 0.9425675675675675, 0.9442567567567568, 0.9442567567567568, 0.9425675675675675, 0.9459459459459459, 0.9493243243243243, 0.9493243243243245, 0.9476351351351352, 0.9493243243243243, 0.9493243243243243, 0.9476351351351351, 0.9476351351351351, 0.9476351351351351, 0.9476351351351351, 0.9476351351351351, 0.9493243243243243, 0.9510135135135135, 0.9510135135135135, 0.9493243243243243, 0.9493243243243243, 0.9459459459459459, 0.9459459459459458, 0.945945945945946, 0.9459459459459459, 0.9459459459459459, 0.9459459459459459, 0.945945945945946, 0.9476351351351352, 0.9476351351351351, 0.9493243243243243, 0.9493243243243242, 0.9493243243243243, 0.9493243243243243, 0.9493243243243243, 0.9493243243243242, 0.9476351351351352, 0.9493243243243243, 0.9493243243243242, 0.9493243243243243, 0.9459459459459459, 0.9476351351351351, 0.9476351351351351, 0.9493243243243243, 0.9493243243243243, 0.9510135135135136, 0.9510135135135135, 0.9510135135135135, 0.9543918918918919, 0.9543918918918919, 0.9543918918918919, 0.956081081081081, 0.9594594594594594, 0.9594594594594594, 0.9594594594594594, 0.9594594594594594, 0.9628378378378378, 0.9662162162162162, 0.9662162162162162, 0.9662162162162162, 0.9662162162162162, 0.9662162162162163, 0.9662162162162162, 0.9662162162162162, 0.9662162162162162, 0.9662162162162162, 0.964527027027027, 0.9628378378378378, 0.9611486486486487, 0.9611486486486487, 0.9628378378378378, 0.9628378378378378, 0.9628378378378379, 0.964527027027027, 0.9645270270270272, 0.964527027027027, 0.9628378378378379, 0.9611486486486486, 0.9628378378378378, 0.9611486486486487, 0.9628378378378378, 0.9628378378378377, 0.9628378378378378, 0.964527027027027, 0.964527027027027, 0.9611486486486487, 0.9611486486486487, 0.9611486486486487, 0.9628378378378379, 0.9628378378378378, 0.9628378378378378, 0.9628378378378378, 0.9645270270270271, 0.9662162162162162, 0.9662162162162162, 0.9662162162162162, 0.9662162162162162, 0.964527027027027, 0.9645270270270271, 0.964527027027027, 0.964527027027027, 0.9628378378378379, 0.9628378378378377, 0.9611486486486487, 0.9628378378378378, 0.9611486486486487, 0.9611486486486487, 0.9611486486486487, 0.9611486486486487, 0.9611486486486487, 0.9611486486486487, 0.9611486486486487, 0.9611486486486487, 0.9628378378378379, 0.9628378378378379, 0.9628378378378378, 0.9628378378378378, 0.9628378378378377, 0.9628378378378378, 0.9611486486486487, 0.9611486486486487, 0.9611486486486486, 0.9611486486486486, 0.9611486486486486, 0.9611486486486487, 0.9611486486486486, 0.9611486486486487, 0.9611486486486487]
# rp_2_prev =[0.6959459459459459, 0.6959459459459459, 0.6875, 0.7043918918918918, 0.7077702702702703, 0.7111486486486486, 0.7162162162162162, 0.7280405405405405, 0.7145270270270271, 0.7280405405405406, 0.7229729729729729, 0.7398648648648648, 0.733108108108108, 0.7280405405405406, 0.7584459459459459, 0.7618243243243243, 0.7702702702702703, 0.7702702702702703, 0.7820945945945945, 0.7888513513513513, 0.7989864864864865, 0.7972972972972973, 0.8023648648648649, 0.8074324324324325, 0.8226351351351351, 0.8260135135135135, 0.8327702702702702, 0.8344594594594594, 0.8361486486486487, 0.8395270270270271, 0.8496621621621621, 0.8429054054054055, 0.8445945945945945, 0.8412162162162162, 0.8445945945945945, 0.839527027027027, 0.8429054054054054, 0.839527027027027, 0.8445945945945946, 0.8429054054054054, 0.8412162162162163, 0.8277027027027027, 0.8327702702702703, 0.8395270270270271, 0.8327702702702703, 0.8361486486486488, 0.8327702702702703, 0.8344594594594595, 0.8378378378378378, 0.8361486486486487, 0.8378378378378379, 0.839527027027027, 0.8412162162162161, 0.839527027027027, 0.8412162162162162, 0.8496621621621622, 0.8412162162162162, 0.8412162162162162, 0.8412162162162162, 0.8395270270270271, 0.839527027027027, 0.8395270270270271, 0.8412162162162162, 0.8412162162162161, 0.8412162162162162, 0.839527027027027, 0.8327702702702703, 0.8327702702702703, 0.831081081081081, 0.8327702702702703, 0.8361486486486487, 0.8344594594594594, 0.8361486486486487, 0.8344594594594594, 0.8496621621621622, 0.8361486486486487, 0.8429054054054055, 0.8429054054054055, 0.847972972972973, 0.8513513513513514, 0.8530405405405406, 0.8547297297297297, 0.8581081081081081, 0.8614864864864864, 0.8648648648648649, 0.8699324324324325, 0.8682432432432432, 0.8682432432432432, 0.8665540540540541, 0.8682432432432432, 0.8682432432432432, 0.8699324324324325, 0.8716216216216216, 0.8733108108108107, 0.8817567567567568, 0.8817567567567568, 0.8851351351351351, 0.883445945945946, 0.8902027027027027, 0.8952702702702703, 0.8918918918918919, 0.8935810810810811, 0.8952702702702703, 0.8986486486486486, 0.8935810810810811, 0.8952702702702703, 0.8952702702702703, 0.8952702702702702, 0.9003378378378378, 0.9003378378378378, 0.8935810810810811, 0.8952702702702703, 0.8969594594594595, 0.8969594594594595, 0.8969594594594594, 0.8986486486486487, 0.902027027027027, 0.9054054054054054, 0.9070945945945946, 0.9070945945945945, 0.910472972972973, 0.910472972972973, 0.9189189189189189, 0.9155405405405406, 0.9206081081081081, 0.9290540540540542, 0.9256756756756758, 0.9290540540540541, 0.9290540540540542, 0.9307432432432432, 0.9341216216216217, 0.9375, 0.9375, 0.9391891891891893, 0.9408783783783784, 0.9408783783783784, 0.9391891891891893, 0.9375000000000001, 0.9408783783783784, 0.9442567567567568, 0.9442567567567568, 0.9442567567567568, 0.9459459459459459, 0.9459459459459459, 0.9459459459459459, 0.9442567567567567, 0.9459459459459458, 0.9459459459459459, 0.9442567567567568, 0.9425675675675677]
# mp_1_prev =[0.0, 0.5219594594594594, 0.5456081081081081, 0.5405405405405406, 0.5337837837837838, 0.5675675675675677, 0.5489864864864865, 0.5371621621621622, 0.5422297297297297, 0.5658783783783784, 0.5810810810810811, 0.5827702702702703, 0.5962837837837838, 0.6131756756756757, 0.6216216216216216, 0.6300675675675677, 0.6283783783783784, 0.6300675675675675, 0.6283783783783784, 0.6283783783783784, 0.6469594594594594, 0.6486486486486486, 0.6418918918918919, 0.6570945945945946, 0.6587837837837838, 0.660472972972973, 0.660472972972973, 0.6621621621621622, 0.6655405405405406, 0.6655405405405406, 0.6587837837837838, 0.6655405405405406, 0.6672297297297298, 0.6672297297297297, 0.6655405405405406, 0.6604729729729729, 0.6739864864864864, 0.6756756756756757, 0.6655405405405405, 0.6706081081081081, 0.6790540540540541, 0.6841216216216217, 0.6773648648648649, 0.6722972972972973, 0.6756756756756757, 0.6875, 0.6908783783783783, 0.6925675675675675, 0.6908783783783784, 0.6976351351351352, 0.6959459459459459, 0.6942567567567568, 0.6891891891891893, 0.6891891891891893, 0.6976351351351351, 0.6976351351351351, 0.7010135135135135, 0.6942567567567568, 0.6976351351351352, 0.7027027027027026, 0.6993243243243243, 0.6993243243243243, 0.6942567567567568, 0.6925675675675675, 0.706081081081081, 0.706081081081081, 0.7043918918918919, 0.7027027027027026, 0.7010135135135135, 0.7128378378378379, 0.7111486486486487, 0.7162162162162162, 0.7162162162162162, 0.7297297297297297, 0.7297297297297298, 0.7179054054054054, 0.7128378378378378, 0.7094594594594594, 0.7179054054054054, 0.7162162162162162, 0.7128378378378378, 0.7145270270270271, 0.7162162162162162, 0.7145270270270271, 0.7128378378378378, 0.7094594594594594, 0.7111486486486487, 0.7060810810810811, 0.7094594594594594, 0.7077702702702702, 0.7077702702702702, 0.7060810810810811, 0.7043918918918919, 0.7060810810810811, 0.7060810810810811, 0.7060810810810811, 0.7094594594594594, 0.7094594594594594, 0.714527027027027, 0.7179054054054054, 0.7179054054054054, 0.722972972972973, 0.722972972972973, 0.731418918918919, 0.7314189189189189, 0.7381756756756757, 0.731418918918919, 0.7398648648648649, 0.7381756756756757, 0.7449324324324325, 0.7483108108108107, 0.7483108108108109, 0.7483108108108107, 0.7483108108108107, 0.75, 0.7533783783783784, 0.7550675675675675, 0.7550675675675675, 0.7533783783783784, 0.7449324324324325, 0.7483108108108109, 0.75, 0.75, 0.758445945945946, 0.758445945945946, 0.7635135135135136, 0.7635135135135136, 0.7635135135135136, 0.7787162162162162, 0.7820945945945946, 0.7820945945945945, 0.7888513513513513, 0.7888513513513513, 0.7888513513513513, 0.793918918918919, 0.7972972972972974, 0.8006756756756757, 0.8006756756756757, 0.8023648648648649, 0.8091216216216216, 0.8125, 0.8158783783783783, 0.8141891891891891, 0.8141891891891891, 0.8175675675675675, 0.8192567567567568, 0.8226351351351351, 0.8327702702702703, 0.8327702702702703, 0.8361486486486486]
# mp_2_prev=[0.0, 0.5304054054054054, 0.5591216216216216, 0.5304054054054054, 0.5236486486486487, 0.5236486486486487, 0.5152027027027027, 0.5236486486486486, 0.5287162162162161, 0.5540540540540541, 0.5709459459459459, 0.5945945945945946, 0.6047297297297297, 0.6131756756756757, 0.6182432432432433, 0.6283783783783784, 0.6283783783783783, 0.6317567567567567, 0.6402027027027027, 0.6486486486486486, 0.6486486486486486, 0.6486486486486486, 0.652027027027027, 0.6503378378378378, 0.6537162162162161, 0.6486486486486486, 0.6520270270270271, 0.6520270270270271, 0.6452702702702703, 0.6503378378378378, 0.6452702702702703, 0.6385135135135135, 0.6418918918918919, 0.6368243243243243, 0.6402027027027027, 0.6368243243243243, 0.6334459459459459, 0.6283783783783784, 0.6266891891891893, 0.6300675675675675, 0.6283783783783783, 0.6283783783783784, 0.6266891891891893, 0.6233108108108107, 0.6199324324324325, 0.6233108108108109, 0.6199324324324325, 0.6182432432432432, 0.616554054054054, 0.6114864864864865, 0.6097972972972973, 0.6131756756756757, 0.6114864864864864, 0.6097972972972973, 0.6131756756756757, 0.6148648648648649, 0.6114864864864864, 0.6148648648648649, 0.6216216216216216, 0.6199324324324325, 0.6300675675675675, 0.6283783783783784, 0.625, 0.6317567567567568, 0.6283783783783784, 0.6317567567567567, 0.6300675675675675, 0.6317567567567568, 0.6317567567567568, 0.6435810810810811, 0.643581081081081, 0.643581081081081, 0.6435810810810811, 0.6418918918918919, 0.6334459459459459, 0.6317567567567568, 0.6317567567567568, 0.6300675675675675, 0.6334459459459459, 0.6300675675675675, 0.6300675675675675, 0.6334459459459459, 0.6266891891891891, 0.6266891891891891, 0.6233108108108107, 0.6233108108108107, 0.6131756756756757, 0.6182432432432432, 0.6199324324324325, 0.6199324324324325, 0.6165540540540541, 0.6165540540540541, 0.6165540540540542, 0.616554054054054, 0.6114864864864865, 0.6165540540540541, 0.6165540540540541, 0.6199324324324325, 0.6266891891891893, 0.625, 0.6351351351351352, 0.643581081081081, 0.6452702702702703, 0.6537162162162162, 0.6537162162162162, 0.6638513513513513, 0.6638513513513513, 0.6621621621621622, 0.6621621621621622, 0.6672297297297297, 0.668918918918919, 0.6807432432432432, 0.6790540540540541, 0.6824324324324325, 0.6756756756756757, 0.6739864864864864, 0.6739864864864864, 0.6722972972972973, 0.6706081081081081, 0.6807432432432432, 0.6739864864864865, 0.6739864864864864, 0.6756756756756757, 0.6756756756756757, 0.6739864864864865, 0.6756756756756757, 0.6773648648648649, 0.6824324324324325, 0.6824324324324325, 0.6824324324324325, 0.6875, 0.6875, 0.6976351351351351, 0.6976351351351351, 0.6976351351351351, 0.7043918918918919, 0.7043918918918919, 0.706081081081081, 0.706081081081081, 0.7094594594594594, 0.7094594594594594, 0.7128378378378378, 0.7162162162162162, 0.7179054054054054, 0.7195945945945945, 0.7280405405405406, 0.7263513513513513, 0.7263513513513513, 0.7263513513513513, 0.7280405405405406]
# m_1_prev=[0.8631756756756757, 0.8597972972972974, 0.8581081081081081, 0.8648648648648649, 0.8631756756756757, 0.8631756756756757, 0.8699324324324325, 0.8665540540540541, 0.8817567567567567, 0.8766891891891893, 0.8699324324324325, 0.8783783783783784, 0.875, 0.8699324324324325, 0.8766891891891893, 0.8733108108108107, 0.8918918918918919, 0.9037162162162162, 0.9121621621621622, 0.9206081081081081, 0.9239864864864865, 0.9256756756756757, 0.9273648648648649, 0.9290540540540541, 0.9341216216216217, 0.9358108108108109, 0.9391891891891893, 0.9391891891891893, 0.9391891891891893, 0.9442567567567568, 0.9442567567567567, 0.9459459459459459, 0.9476351351351351, 0.9493243243243243, 0.9493243243243242, 0.9493243243243243, 0.9493243243243243, 0.9493243243243243, 0.9476351351351351, 0.9476351351351352, 0.945945945945946, 0.9476351351351352, 0.9510135135135135, 0.9543918918918919, 0.9527027027027027, 0.9527027027027026, 0.9527027027027026, 0.9527027027027026, 0.9527027027027027, 0.9527027027027027, 0.9527027027027026, 0.9527027027027026, 0.9543918918918919, 0.9527027027027026, 0.9527027027027027, 0.9527027027027026, 0.9543918918918918, 0.9543918918918919, 0.9527027027027027, 0.9527027027027027, 0.9527027027027026, 0.9543918918918919, 0.954391891891892, 0.9510135135135136, 0.9510135135135136, 0.9527027027027027, 0.9527027027027027, 0.9560810810810811, 0.9560810810810809, 0.9611486486486486, 0.9645270270270271, 0.9645270270270271, 0.964527027027027, 0.964527027027027, 0.9679054054054054, 0.9679054054054055, 0.9695945945945945, 0.9679054054054054, 0.9695945945945945, 0.9712837837837839, 0.9729729729729729, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9763513513513513, 0.9763513513513513, 0.9763513513513514, 0.9763513513513513, 0.9763513513513513, 0.9763513513513513, 0.9763513513513513, 0.9763513513513513, 0.9763513513513514, 0.9763513513513514, 0.9763513513513514, 0.9780405405405406, 0.9780405405405406, 0.9797297297297297, 0.9763513513513513, 0.9780405405405406, 0.9780405405405406, 0.9780405405405406, 0.9780405405405405, 0.9780405405405406, 0.9780405405405406, 0.9780405405405406, 0.9780405405405406, 0.9780405405405405, 0.9797297297297298, 0.9763513513513513, 0.9763513513513513, 0.9763513513513514, 0.9763513513513514, 0.9763513513513513, 0.9763513513513513, 0.9780405405405405, 0.9780405405405405, 0.9780405405405405, 0.9780405405405405, 0.9780405405405405, 0.9780405405405406, 0.9780405405405405, 0.9780405405405406, 0.9780405405405405, 0.9780405405405406, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9729729729729729, 0.972972972972973, 0.9746621621621622, 0.9763513513513513, 0.9763513513513513, 0.9763513513513513, 0.9763513513513513, 0.9746621621621622, 0.9746621621621622, 0.9746621621621622, 0.9712837837837838, 0.9679054054054055, 0.9695945945945946]
# m_2_prev =[0.6959459459459459, 0.6925675675675675, 0.6875, 0.7010135135135135, 0.6993243243243242, 0.7010135135135135, 0.7111486486486486, 0.7195945945945946, 0.722972972972973, 0.7212837837837839, 0.731418918918919, 0.7212837837837838, 0.733108108108108, 0.7212837837837838, 0.7128378378378378, 0.7263513513513513, 0.7466216216216216, 0.7533783783783784, 0.7668918918918919, 0.7736486486486487, 0.7753378378378378, 0.7804054054054054, 0.7888513513513513, 0.8023648648648648, 0.7956081081081081, 0.804054054054054, 0.7989864864864865, 0.8108108108108109, 0.8192567567567568, 0.8209459459459459, 0.8192567567567568, 0.8226351351351351, 0.8260135135135135, 0.8260135135135136, 0.8243243243243243, 0.8293918918918919, 0.8277027027027026, 0.8277027027027027, 0.8260135135135135, 0.8243243243243243, 0.8293918918918919, 0.8327702702702703, 0.8378378378378378, 0.8378378378378378, 0.839527027027027, 0.8395270270270271, 0.8462837837837838, 0.8462837837837838, 0.847972972972973, 0.8462837837837838, 0.847972972972973, 0.847972972972973, 0.8445945945945946, 0.8412162162162162, 0.8445945945945946, 0.8361486486486487, 0.8327702702702703, 0.8327702702702702, 0.8293918918918919, 0.8310810810810811, 0.8310810810810811, 0.831081081081081, 0.831081081081081, 0.8378378378378378, 0.8412162162162162, 0.8429054054054054, 0.8412162162162162, 0.8412162162162161, 0.8429054054054054, 0.8429054054054054, 0.8479729729729729, 0.8462837837837838, 0.8429054054054054, 0.8479729729729729, 0.847972972972973, 0.847972972972973, 0.8479729729729729, 0.8496621621621622, 0.8530405405405405, 0.8581081081081081, 0.858108108108108, 0.8614864864864865, 0.8631756756756757, 0.8699324324324325, 0.8699324324324323, 0.8716216216216216, 0.8733108108108107, 0.875, 0.8783783783783784, 0.875, 0.8766891891891891, 0.8766891891891891, 0.8817567567567567, 0.8834459459459459, 0.8834459459459459, 0.893581081081081, 0.8952702702702703, 0.8986486486486487, 0.9020270270270271, 0.9037162162162162, 0.910472972972973, 0.9104729729729729, 0.9172297297297298, 0.9172297297297298, 0.9172297297297296, 0.9155405405405406, 0.9172297297297298, 0.9172297297297296, 0.9172297297297298, 0.9155405405405406, 0.9155405405405406, 0.9155405405405406, 0.9172297297297297, 0.9172297297297297, 0.9155405405405406, 0.9155405405405405, 0.9206081081081081, 0.9206081081081081, 0.9206081081081081, 0.918918918918919, 0.9222972972972973, 0.9324324324324325, 0.9341216216216216, 0.9358108108108109, 0.9341216216216217, 0.9324324324324325, 0.9358108108108107, 0.9358108108108109, 0.9341216216216216, 0.9358108108108109, 0.9358108108108109, 0.9425675675675675, 0.9442567567567567, 0.9442567567567568, 0.9510135135135135, 0.9527027027027026, 0.9527027027027026, 0.9543918918918919, 0.9560810810810811, 0.9577702702702703, 0.9577702702702703, 0.9594594594594594, 0.9560810810810811, 0.9560810810810811, 0.9594594594594594, 0.9594594594594594, 0.9594594594594594, 0.9594594594594594, 0.9594594594594595, 0.9594594594594594]
#
# rp_1_mid =[0.8631756756756757, 0.8597972972972973, 0.866554054054054, 0.8648648648648649, 0.8631756756756757, 0.8631756756756757, 0.8699324324324325, 0.8648648648648648, 0.8699324324324325, 0.8716216216216216, 0.8682432432432433, 0.8716216216216216, 0.8716216216216216, 0.8648648648648649, 0.8614864864864865, 0.8614864864864865, 0.8682432432432432, 0.866554054054054, 0.8648648648648649, 0.8648648648648649, 0.8648648648648648, 0.8631756756756757, 0.866554054054054, 0.8648648648648647, 0.8648648648648649, 0.8564189189189189, 0.8547297297297297, 0.8547297297297297, 0.8547297297297298, 0.856418918918919, 0.8412162162162162, 0.8581081081081081, 0.8665540540540541, 0.8682432432432432, 0.8800675675675675, 0.8902027027027026, 0.8986486486486487, 0.8902027027027026, 0.8902027027027026, 0.9003378378378378, 0.9003378378378378, 0.9003378378378379, 0.910472972972973, 0.910472972972973, 0.9104729729729729, 0.9189189189189189, 0.9189189189189189, 0.9222972972972973, 0.9222972972972973, 0.9222972972972974, 0.9222972972972973, 0.9290540540540541, 0.9290540540540542, 0.9341216216216217, 0.9358108108108107, 0.9375, 0.9358108108108107, 0.9358108108108107, 0.9358108108108109, 0.9358108108108107, 0.9358108108108107, 0.9375, 0.9375, 0.9425675675675675, 0.9408783783783784, 0.9391891891891893, 0.9391891891891893, 0.9408783783783784, 0.9391891891891893, 0.9408783783783784, 0.9408783783783784, 0.9408783783783784, 0.9408783783783784, 0.9391891891891891, 0.9442567567567568, 0.9442567567567568, 0.9442567567567568, 0.9442567567567568, 0.9476351351351351, 0.9459459459459459, 0.9459459459459459, 0.9442567567567568, 0.9442567567567568, 0.9442567567567568, 0.9442567567567568, 0.9442567567567568, 0.945945945945946, 0.9425675675675675, 0.9459459459459459, 0.9459459459459459, 0.9459459459459459, 0.9476351351351351, 0.9459459459459458, 0.945945945945946, 0.9459459459459458, 0.9476351351351351, 0.9493243243243243, 0.9459459459459458, 0.9476351351351351, 0.9476351351351351, 0.945945945945946, 0.9476351351351351, 0.9476351351351351, 0.9476351351351352, 0.9476351351351351, 0.9493243243243243, 0.9408783783783784, 0.9408783783783785, 0.9459459459459459, 0.9442567567567568, 0.9442567567567568, 0.9425675675675675, 0.9408783783783784, 0.9391891891891891, 0.9408783783783784, 0.9391891891891891, 0.9391891891891891, 0.9391891891891893, 0.9391891891891893, 0.9391891891891891, 0.9391891891891891, 0.9391891891891891, 0.9442567567567568, 0.9391891891891893, 0.9391891891891893, 0.9391891891891893, 0.9391891891891893, 0.9391891891891891, 0.9425675675675675, 0.9408783783783783, 0.9425675675675675, 0.9493243243243243, 0.9493243243243243, 0.9493243243243243, 0.9476351351351352, 0.9476351351351352, 0.9493243243243243, 0.9442567567567568, 0.9476351351351351, 0.9476351351351351, 0.9476351351351351, 0.9476351351351351, 0.9476351351351351, 0.9476351351351351, 0.9493243243243243, 0.9493243243243243, 0.9493243243243243, 0.9510135135135136, 0.9493243243243243, 0.9493243243243243]
# rp_2_mid =[0.6959459459459459, 0.6841216216216216, 0.6908783783783784, 0.7043918918918919, 0.6976351351351351, 0.7077702702702703, 0.7043918918918918, 0.7179054054054054, 0.7162162162162162, 0.7314189189189189, 0.7381756756756757, 0.7364864864864865, 0.7381756756756755, 0.7398648648648648, 0.731418918918919, 0.7364864864864865, 0.7364864864864864, 0.7347972972972974, 0.7381756756756757, 0.7364864864864864, 0.7398648648648649, 0.7314189189189189, 0.7314189189189189, 0.7263513513513513, 0.7162162162162162, 0.7195945945945946, 0.7162162162162162, 0.7111486486486487, 0.7111486486486487, 0.7128378378378379, 0.7010135135135135, 0.714527027027027, 0.7179054054054055, 0.7280405405405406, 0.7381756756756757, 0.7415540540540541, 0.7601351351351351, 0.7483108108108107, 0.7567567567567568, 0.7601351351351351, 0.7652027027027026, 0.7567567567567568, 0.7668918918918919, 0.7618243243243243, 0.7635135135135135, 0.7567567567567568, 0.7635135135135136, 0.7652027027027026, 0.7652027027027027, 0.7635135135135135, 0.7685810810810811, 0.7635135135135135, 0.7635135135135135, 0.768581081081081, 0.7668918918918919, 0.7685810810810811, 0.7618243243243242, 0.7601351351351352, 0.7533783783783784, 0.7567567567567567, 0.7567567567567567, 0.7533783783783784, 0.7500000000000001, 0.7567567567567567, 0.7533783783783784, 0.7567567567567567, 0.7550675675675675, 0.7584459459459459, 0.7533783783783784, 0.7635135135135135, 0.7635135135135136, 0.7652027027027027, 0.7652027027027026, 0.7618243243243242, 0.7635135135135135, 0.7635135135135135, 0.7635135135135135, 0.7618243243243243, 0.7652027027027026, 0.7668918918918919, 0.7533783783783784, 0.75, 0.75, 0.75, 0.7483108108108109, 0.7466216216216216, 0.7415540540540541, 0.7432432432432432, 0.7432432432432433, 0.7449324324324325, 0.7432432432432433, 0.7449324324324323, 0.7483108108108109, 0.7466216216216216, 0.7466216216216215, 0.7516891891891893, 0.7483108108108107, 0.7466216216216217, 0.75, 0.7516891891891891, 0.7516891891891891, 0.7516891891891893, 0.7499999999999999, 0.7466216216216216, 0.7466216216216216, 0.7483108108108107, 0.7483108108108107, 0.7500000000000001, 0.75, 0.7516891891891891, 0.7533783783783784, 0.7432432432432432, 0.7449324324324325, 0.7466216216216216, 0.75, 0.75, 0.7533783783783783, 0.7601351351351351, 0.7601351351351352, 0.75, 0.7533783783783784, 0.7635135135135135, 0.7550675675675675, 0.7533783783783784, 0.7652027027027027, 0.7652027027027026, 0.7652027027027026, 0.768581081081081, 0.7652027027027027, 0.7567567567567568, 0.7550675675675675, 0.7635135135135135, 0.7516891891891893, 0.7516891891891893, 0.75, 0.75, 0.7516891891891893, 0.7652027027027027, 0.7280405405405406, 0.7280405405405405, 0.7331081081081081, 0.7314189189189189, 0.7314189189189189, 0.7246621621621622, 0.7212837837837839, 0.7195945945945945, 0.7179054054054055, 0.7195945945945946, 0.7162162162162162, 0.7212837837837838]
# mp_1_mid =[0.0, 0.5219594594594594, 0.6081081081081081, 0.6317567567567568, 0.6300675675675675, 0.5861486486486487, 0.5658783783783783, 0.5219594594594594, 0.48986486486486486, 0.4763513513513513, 0.49155405405405406, 0.5033783783783784, 0.5033783783783784, 0.4864864864864865, 0.4966216216216216, 0.49493243243243246, 0.5016891891891893, 0.5016891891891891, 0.5, 0.5135135135135135, 0.5168918918918919, 0.5135135135135136, 0.5320945945945945, 0.5337837837837838, 0.5371621621621622, 0.5489864864864864, 0.5523648648648648, 0.5574324324324325, 0.5540540540540541, 0.5574324324324325, 0.5692567567567568, 0.5726351351351352, 0.5709459459459459, 0.5658783783783784, 0.5675675675675675, 0.5692567567567567, 0.5658783783783784, 0.5608108108108109, 0.5625, 0.5641891891891893, 0.5591216216216217, 0.5608108108108109, 0.5608108108108109, 0.5726351351351351, 0.5625, 0.5641891891891893, 0.5777027027027026, 0.5760135135135135, 0.5810810810810811, 0.5827702702702703, 0.5810810810810811, 0.5793918918918919, 0.5625, 0.5625, 0.5692567567567568, 0.5641891891891893, 0.5608108108108109, 0.5608108108108109, 0.5591216216216216, 0.5574324324324325, 0.5625, 0.5625, 0.5608108108108109, 0.5591216216216217, 0.5591216216216216, 0.5591216216216216, 0.5574324324324325, 0.5574324324324325, 0.5557432432432432, 0.5557432432432432, 0.5472972972972973, 0.5658783783783783, 0.5641891891891893, 0.5641891891891893, 0.5641891891891891, 0.5641891891891891, 0.5641891891891891, 0.5658783783783784, 0.5658783783783783, 0.5641891891891893, 0.5641891891891891, 0.5692567567567568, 0.5658783783783784, 0.5658783783783784, 0.5658783783783784, 0.5692567567567568, 0.5692567567567568, 0.5692567567567567, 0.5692567567567567, 0.5658783783783784, 0.5658783783783785, 0.5692567567567568, 0.589527027027027, 0.5878378378378378, 0.5878378378378378, 0.5912162162162162, 0.5912162162162162, 0.5912162162162162, 0.5912162162162162, 0.6013513513513513, 0.6013513513513513, 0.6030405405405406, 0.6013513513513513, 0.6097972972972973, 0.6081081081081081, 0.6064189189189189, 0.6064189189189189, 0.6064189189189189, 0.6114864864864864, 0.6114864864864864, 0.6233108108108107, 0.6216216216216216, 0.6216216216216216, 0.625, 0.6233108108108107, 0.6216216216216217, 0.6216216216216217, 0.6216216216216217, 0.6199324324324325, 0.6216216216216217, 0.6216216216216217, 0.6199324324324325, 0.6182432432432432, 0.6216216216216216, 0.6216216216216216, 0.6300675675675675, 0.6300675675675675, 0.6385135135135135, 0.6368243243243243, 0.6351351351351351, 0.6351351351351351, 0.6351351351351351, 0.6317567567567568, 0.6300675675675675, 0.6368243243243242, 0.6351351351351351, 0.6351351351351352, 0.6317567567567568, 0.6317567567567568, 0.6300675675675675, 0.6283783783783784, 0.6334459459459459, 0.6486486486486487, 0.6486486486486487, 0.6486486486486487, 0.6486486486486487, 0.6486486486486487, 0.6486486486486487, 0.6469594594594594, 0.6469594594594594]
# mp_2_mid =[0.0, 0.5304054054054054, 0.6587837837837838, 0.6283783783783784, 0.6554054054054055, 0.597972972972973, 0.5540540540540541, 0.4966216216216216, 0.46959459459459457, 0.4932432432432432, 0.49493243243243235, 0.4949324324324324, 0.4949324324324324, 0.49493243243243246, 0.49831081081081086, 0.4966216216216216, 0.49324324324324326, 0.5, 0.4966216216216216, 0.5135135135135135, 0.5168918918918919, 0.5168918918918919, 0.518581081081081, 0.5371621621621622, 0.5422297297297297, 0.5388513513513514, 0.5472972972972974, 0.5641891891891893, 0.5608108108108107, 0.5625, 0.5523648648648649, 0.5540540540540541, 0.5591216216216216, 0.5557432432432432, 0.5574324324324325, 0.5574324324324325, 0.5574324324324325, 0.5489864864864864, 0.5523648648648649, 0.5692567567567568, 0.5591216216216216, 0.5591216216216217, 0.5574324324324325, 0.5692567567567568, 0.5608108108108109, 0.5608108108108107, 0.5608108108108107, 0.5608108108108107, 0.5591216216216216, 0.570945945945946, 0.5692567567567567, 0.5658783783783783, 0.5658783783783784, 0.5540540540540541, 0.5523648648648648, 0.5506756756756757, 0.5489864864864864, 0.5506756756756757, 0.5709459459459459, 0.570945945945946, 0.5675675675675675, 0.5675675675675675, 0.5658783783783783, 0.5625, 0.5608108108108109, 0.5625, 0.5641891891891891, 0.5641891891891893, 0.5608108108108109, 0.5591216216216216, 0.5591216216216216, 0.5608108108108107, 0.5608108108108109, 0.5608108108108109, 0.5591216216216216, 0.5743243243243243, 0.5743243243243243, 0.5726351351351351, 0.5658783783783784, 0.5658783783783784, 0.5658783783783784, 0.5641891891891891, 0.5625000000000001, 0.5641891891891891, 0.5641891891891891, 0.5641891891891891, 0.5743243243243243, 0.5692567567567568, 0.5675675675675677, 0.5675675675675677, 0.5743243243243242, 0.5709459459459459, 0.5692567567567567, 0.5709459459459459, 0.5912162162162161, 0.5912162162162161, 0.5912162162162161, 0.5929054054054054, 0.5912162162162161, 0.5878378378378378, 0.5810810810810811, 0.5844594594594594, 0.5827702702702703, 0.5827702702702703, 0.5827702702702703, 0.581081081081081, 0.5878378378378378, 0.5861486486486486, 0.5861486486486486, 0.5844594594594595, 0.5793918918918919, 0.5912162162162162, 0.6064189189189189, 0.6030405405405406, 0.5996621621621621, 0.5996621621621622, 0.6064189189189189, 0.6064189189189189, 0.6131756756756757, 0.6131756756756757, 0.6097972972972974, 0.6081081081081081, 0.6114864864864865, 0.6081081081081081, 0.6047297297297297, 0.6047297297297297, 0.6148648648648648, 0.6114864864864865, 0.6216216216216216, 0.6216216216216216, 0.6216216216216216, 0.6266891891891891, 0.6233108108108107, 0.6233108108108107, 0.6216216216216217, 0.6300675675675675, 0.6283783783783784, 0.6266891891891891, 0.625, 0.6199324324324323, 0.6199324324324325, 0.6351351351351352, 0.6351351351351351, 0.6402027027027027, 0.6402027027027026, 0.6402027027027026, 0.6402027027027026, 0.6452702702702703, 0.6418918918918919, 0.6418918918918919]
# m_1_mid = [0.8631756756756757, 0.8597972972972974, 0.8581081081081081, 0.8648648648648649, 0.8631756756756757, 0.8631756756756757, 0.8682432432432432, 0.8648648648648649, 0.875, 0.8699324324324325, 0.8631756756756757, 0.8716216216216217, 0.8682432432432432, 0.8631756756756757, 0.8699324324324325, 0.8665540540540542, 0.8631756756756757, 0.8648648648648649, 0.8631756756756757, 0.8631756756756757, 0.8648648648648649, 0.8665540540540541, 0.8682432432432432, 0.8665540540540541, 0.8581081081081081, 0.8581081081081081, 0.8597972972972974, 0.8597972972972974, 0.8614864864864866, 0.847972972972973, 0.847972972972973, 0.847972972972973, 0.8496621621621622, 0.8378378378378379, 0.8378378378378377, 0.839527027027027, 0.839527027027027, 0.8412162162162162, 0.8378378378378378, 0.8378378378378379, 0.8378378378378379, 0.8378378378378378, 0.8344594594594594, 0.8361486486486487, 0.8378378378378378, 0.8378378378378379, 0.8310810810810811, 0.8310810810810811, 0.8277027027027026, 0.8277027027027026, 0.8175675675675675, 0.8192567567567568, 0.8175675675675675, 0.8175675675675677, 0.8175675675675675, 0.8125, 0.8125, 0.8158783783783784, 0.8158783783783784, 0.8158783783783784, 0.8158783783783784, 0.8158783783783784, 0.8158783783783784, 0.8158783783783784, 0.8158783783783784, 0.8192567567567567, 0.8192567567567568, 0.8192567567567567, 0.8209459459459459, 0.8209459459459459, 0.8260135135135135, 0.8277027027027027, 0.829391891891892, 0.831081081081081, 0.8327702702702703, 0.8327702702702703, 0.8310810810810811, 0.8310810810810811, 0.8344594594594594, 0.8361486486486486, 0.839527027027027, 0.839527027027027, 0.8412162162162162, 0.8445945945945945, 0.8462837837837838, 0.8462837837837838, 0.8462837837837838, 0.8462837837837838, 0.8462837837837838, 0.847972972972973, 0.847972972972973, 0.8479729729729729, 0.8462837837837838, 0.8462837837837838, 0.8462837837837838, 0.8445945945945947, 0.8445945945945946, 0.8445945945945946, 0.8429054054054055, 0.8429054054054054, 0.8530405405405406, 0.8530405405405406, 0.8547297297297297, 0.8547297297297297, 0.8513513513513513, 0.8496621621621622, 0.847972972972973, 0.8479729729729729, 0.8479729729729729, 0.847972972972973, 0.8479729729729729, 0.8479729729729729, 0.8479729729729729, 0.8479729729729729, 0.8530405405405405, 0.8547297297297297, 0.856418918918919, 0.856418918918919, 0.856418918918919, 0.8581081081081081, 0.8581081081081081, 0.8581081081081081, 0.8597972972972973, 0.8597972972972973, 0.8597972972972974, 0.8597972972972974, 0.8733108108108107, 0.8733108108108107, 0.8733108108108107, 0.8733108108108107, 0.8733108108108107, 0.8733108108108109, 0.8733108108108109, 0.8733108108108109, 0.8733108108108109, 0.8733108108108107, 0.8733108108108109, 0.8733108108108109, 0.8733108108108109, 0.8749999999999999, 0.8902027027027027, 0.8918918918918919, 0.891891891891892, 0.891891891891892, 0.8902027027027027, 0.8902027027027027, 0.8902027027027027, 0.891891891891892, 0.893581081081081, 0.8952702702702703]
# m_2_mid =[0.6959459459459459, 0.6925675675675675, 0.6891891891891891, 0.6993243243243243, 0.6976351351351352, 0.7027027027027027, 0.6993243243243242, 0.7060810810810811, 0.7212837837837839, 0.7162162162162162, 0.7229729729729729, 0.7246621621621622, 0.722972972972973, 0.7246621621621622, 0.7229729729729729, 0.7162162162162162, 0.7195945945945946, 0.7212837837837838, 0.7246621621621621, 0.7263513513513513, 0.7280405405405406, 0.7280405405405406, 0.7297297297297298, 0.7297297297297296, 0.7195945945945946, 0.7297297297297297, 0.7212837837837839, 0.7212837837837838, 0.7195945945945945, 0.714527027027027, 0.7111486486486487, 0.706081081081081, 0.7060810810810811, 0.7027027027027026, 0.7043918918918919, 0.6976351351351351, 0.7010135135135135, 0.6875, 0.6891891891891893, 0.6807432432432432, 0.6722972972972974, 0.6756756756756757, 0.6621621621621622, 0.6655405405405406, 0.6604729729729729, 0.6570945945945945, 0.6520270270270271, 0.6503378378378378, 0.6469594594594594, 0.643581081081081, 0.643581081081081, 0.6402027027027027, 0.6486486486486486, 0.6469594594594594, 0.6351351351351352, 0.6351351351351352, 0.625, 0.6114864864864865, 0.6114864864864865, 0.6233108108108109, 0.6216216216216216, 0.6199324324324325, 0.6114864864864865, 0.6131756756756757, 0.606418918918919, 0.6097972972972973, 0.6097972972972973, 0.6097972972972974, 0.6047297297297297, 0.6047297297297298, 0.6081081081081081, 0.6131756756756757, 0.6165540540540541, 0.6182432432432432, 0.6081081081081081, 0.6114864864864865, 0.6131756756756757, 0.6199324324324325, 0.6199324324324325, 0.6199324324324325, 0.6165540540540541, 0.6233108108108107, 0.6368243243243243, 0.6385135135135136, 0.6300675675675675, 0.6300675675675675, 0.6351351351351351, 0.6385135135135136, 0.6402027027027026, 0.6418918918918919, 0.6418918918918919, 0.6368243243243242, 0.6266891891891891, 0.6385135135135135, 0.641891891891892, 0.6418918918918919, 0.6452702702702703, 0.6469594594594594, 0.6537162162162162, 0.6570945945945946, 0.6587837837837838, 0.6587837837837838, 0.6537162162162162, 0.6554054054054054, 0.660472972972973, 0.6689189189189189, 0.6773648648648649, 0.6621621621621621, 0.6655405405405406, 0.679054054054054, 0.6807432432432432, 0.6739864864864864, 0.6756756756756757, 0.6773648648648648, 0.6824324324324323, 0.6824324324324325, 0.6959459459459459, 0.6976351351351351, 0.7027027027027027, 0.6925675675675675, 0.6942567567567568, 0.7010135135135136, 0.714527027027027, 0.7195945945945945, 0.7246621621621622, 0.7314189189189189, 0.7331081081081081, 0.7347972972972973, 0.7432432432432432, 0.7483108108108107, 0.7533783783783784, 0.7533783783783784, 0.7618243243243242, 0.7618243243243243, 0.7668918918918919, 0.7702702702702703, 0.7736486486486487, 0.7719594594594595, 0.7702702702702703, 0.7736486486486486, 0.7736486486486486, 0.7787162162162161, 0.7804054054054054, 0.7820945945945946, 0.7820945945945946, 0.7820945945945946, 0.7837837837837838, 0.7820945945945946, 0.7854729729729729, 0.768581081081081]



###### CPU with correct day window ######
# rp_1_prev = [0.4576271186440678, 0.9152542372881356, 0.9152542372881355, 0.9364406779661016, 0.9364406779661016, 0.9364406779661018, 0.9872881355932204, 0.9830508474576272, 0.9830508474576272, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9957627118644068, 0.9957627118644068, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 0.9957627118644068, 1.0, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644067, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 1.0, 1.0, 0.9957627118644068, 1.0, 1.0, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 1.0, 1.0, 0.9957627118644068, 0.9957627118644067, 0.9999999999999999, 0.9957627118644067, 0.9957627118644068, 0.9957627118644069, 1.0, 1.0, 0.9957627118644068, 1.0, 0.9957627118644067, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 0.9957627118644068, 0.9957627118644067, 0.9999999999999998, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 0.9957627118644068, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 0.9957627118644067, 0.9999999999999999, 1.0, 1.0]
# rp_2_prev = [0.3813559322033898, 0.8305084745762712, 0.7754237288135593, 0.8177966101694915, 0.788135593220339, 0.8559322033898306, 0.8516949152542374, 0.8771186440677967, 0.8686440677966102, 0.8559322033898304, 0.8813559322033898, 0.8983050847457628, 0.8983050847457628, 0.8940677966101696, 0.8898305084745761, 0.902542372881356, 0.8983050847457628, 0.8983050847457628, 0.8898305084745762, 0.8686440677966101, 0.8516949152542372, 0.8389830508474576, 0.8728813559322034, 0.8644067796610169, 0.8601694915254237, 0.7542372881355932, 0.7966101694915254, 0.8432203389830508, 0.8516949152542372, 0.847457627118644, 0.8559322033898306, 0.728813559322034, 0.7245762711864406, 0.6779661016949152, 0.7203389830508474, 0.7584745762711864, 0.7584745762711864, 0.6186440677966101, 0.6483050847457628, 0.6906779661016949, 0.7161016949152542, 0.6991525423728813, 0.7584745762711864, 0.7033898305084746, 0.6864406779661016, 0.7245762711864407, 0.7627118644067796, 0.7669491525423728, 0.7923728813559323, 0.7754237288135593, 0.7627118644067796, 0.8050847457627118, 0.8008474576271186, 0.8050847457627119, 0.8008474576271185, 0.7542372881355932, 0.7754237288135593, 0.771186440677966, 0.8008474576271186, 0.8093220338983051, 0.7838983050847457, 0.7203389830508474, 0.7288135593220338, 0.7627118644067796, 0.7372881355932204, 0.8050847457627118, 0.8008474576271186, 0.7584745762711864, 0.7669491525423728, 0.7796610169491525, 0.7796610169491525, 0.809322033898305, 0.8050847457627119, 0.711864406779661, 0.7415254237288136, 0.7627118644067796, 0.809322033898305, 0.788135593220339, 0.8220338983050848, 0.7245762711864407, 0.7330508474576272, 0.7669491525423728, 0.7669491525423728, 0.7754237288135593, 0.8008474576271186, 0.7330508474576272, 0.826271186440678, 0.8177966101694916, 0.8771186440677966, 0.8813559322033898, 0.885593220338983, 0.8559322033898304, 0.8516949152542372, 0.8728813559322034, 0.8898305084745762, 0.8771186440677966, 0.8898305084745762, 0.8601694915254238, 0.8644067796610169, 0.864406779661017, 0.8771186440677966, 0.8983050847457628, 0.8940677966101694, 0.8644067796610169, 0.8686440677966102, 0.8601694915254238, 0.8771186440677967, 0.885593220338983, 0.8813559322033899, 0.8389830508474576, 0.8177966101694916, 0.8389830508474576, 0.8516949152542372, 0.885593220338983, 0.885593220338983, 0.8474576271186441, 0.8728813559322034, 0.8940677966101696, 0.8813559322033899, 0.8898305084745763, 0.8940677966101694, 0.902542372881356, 0.902542372881356, 0.9067796610169492, 0.9067796610169492, 0.902542372881356, 0.8983050847457628, 0.8771186440677966, 0.8771186440677967, 0.8771186440677967, 0.8898305084745762, 0.8983050847457628, 0.8940677966101696, 0.8983050847457628, 0.8813559322033899, 0.8813559322033899, 0.8559322033898304, 0.8983050847457628, 0.8983050847457628, 0.8983050847457628, 0.8983050847457628, 0.902542372881356, 0.9025423728813559, 0.902542372881356, 0.8983050847457628, 0.8940677966101694, 0.8983050847457628, 0.8940677966101696, 0.9025423728813559, 0.9025423728813559]
# mp_1_prev = [0.0, 0.9449152542372882, 0.7627118644067796, 0.6864406779661018, 0.6271186440677966, 0.576271186440678, 0.4406779661016949, 0.3813559322033898, 0.40254237288135597, 0.4703389830508475, 0.4703389830508475, 0.461864406779661, 0.4957627118644068, 0.4915254237288136, 0.5042372881355932, 0.5296610169491525, 0.5127118644067796, 0.5338983050847457, 0.4872881355932203, 0.4661016949152542, 0.4661016949152542, 0.47457627118644063, 0.4576271186440678, 0.4576271186440678, 0.4915254237288136, 0.5127118644067796, 0.4915254237288136, 0.44491525423728817, 0.4364406779661017, 0.41525423728813554, 0.4576271186440678, 0.4576271186440678, 0.4322033898305085, 0.41525423728813554, 0.41525423728813554, 0.3898305084745763, 0.41525423728813554, 0.4322033898305085, 0.423728813559322, 0.3940677966101695, 0.3940677966101695, 0.38983050847457623, 0.38983050847457623, 0.3983050847457627, 0.38983050847457623, 0.38983050847457623, 0.38983050847457623, 0.385593220338983, 0.385593220338983, 0.38983050847457623, 0.38983050847457623, 0.38983050847457623, 0.3983050847457627, 0.3940677966101695, 0.3983050847457627, 0.3983050847457627, 0.4067796610169491, 0.4025423728813559, 0.3983050847457627, 0.3983050847457627, 0.4025423728813559, 0.3940677966101695, 0.38983050847457623, 0.4067796610169491, 0.4025423728813559, 0.3983050847457627, 0.40254237288135597, 0.3983050847457627, 0.3940677966101695, 0.38983050847457623, 0.4067796610169492, 0.40254237288135597, 0.38983050847457623, 0.3983050847457627, 0.3940677966101695, 0.3940677966101695, 0.3940677966101695, 0.38983050847457623, 0.3940677966101695, 0.3898305084745763, 0.3983050847457627, 0.3940677966101695, 0.3940677966101695, 0.3940677966101695, 0.3940677966101695, 0.3898305084745763, 0.3983050847457627, 0.3940677966101695, 0.3940677966101695, 0.3940677966101695, 0.3940677966101695, 0.38983050847457623, 0.3983050847457627, 0.3983050847457627, 0.3940677966101695, 0.3940677966101695, 0.3983050847457627, 0.4067796610169491, 0.3940677966101695, 0.4194915254237288, 0.4194915254237288, 0.4194915254237288, 0.3940677966101695, 0.4067796610169492, 0.3983050847457627, 0.3940677966101695, 0.3940677966101695, 0.4152542372881356, 0.3940677966101695, 0.4110169491525424, 0.4279661016949152, 0.4279661016949152, 0.4194915254237288, 0.4194915254237288, 0.4279661016949152, 0.4152542372881356, 0.3983050847457627, 0.4279661016949152, 0.4279661016949152, 0.423728813559322, 0.3940677966101695, 0.4110169491525424, 0.3940677966101695, 0.3940677966101695, 0.3940677966101695, 0.4279661016949152, 0.3940677966101695, 0.4110169491525424, 0.3940677966101695, 0.4279661016949152, 0.4279661016949152, 0.4194915254237288, 0.423728813559322, 0.4152542372881356, 0.3983050847457627, 0.3983050847457627, 0.4279661016949152, 0.4279661016949152, 0.3983050847457627, 0.4067796610169492, 0.40254237288135597, 0.40254237288135597, 0.3940677966101695, 0.3898305084745763, 0.3983050847457627, 0.423728813559322, 0.3983050847457627, 0.3983050847457627, 0.3983050847457627, 0.3940677966101695]
# mp_2_prev = [0.0, 0.9067796610169491, 0.6567796610169492, 0.6864406779661018, 0.635593220338983, 0.6313559322033899, 0.4279661016949153, 0.3516949152542373, 0.385593220338983, 0.423728813559322, 0.423728813559322, 0.4279661016949152, 0.4533898305084746, 0.4703389830508475, 0.4788135593220339, 0.4915254237288136, 0.5, 0.4957627118644068, 0.4661016949152542, 0.4322033898305085, 0.4152542372881356, 0.423728813559322, 0.4406779661016949, 0.4449152542372881, 0.4364406779661017, 0.4576271186440678, 0.4364406779661017, 0.4110169491525424, 0.4110169491525424, 0.4364406779661017, 0.4110169491525424, 0.4364406779661017, 0.4279661016949153, 0.3686440677966102, 0.3771186440677966, 0.3771186440677966, 0.3813559322033898, 0.3855932203389831, 0.3813559322033898, 0.3813559322033898, 0.3813559322033898, 0.3983050847457627, 0.3728813559322034, 0.364406779661017, 0.3686440677966102, 0.3813559322033898, 0.3813559322033898, 0.3855932203389831, 0.3855932203389831, 0.3728813559322034, 0.385593220338983, 0.3771186440677966, 0.3644067796610169, 0.35593220338983045, 0.36864406779661013, 0.3728813559322034, 0.3644067796610169, 0.3644067796610169, 0.3644067796610169, 0.34745762711864403, 0.3728813559322034, 0.3601694915254237, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3559322033898305, 0.34745762711864403, 0.3389830508474576, 0.3347457627118644, 0.3305084745762712, 0.36016949152542377, 0.3347457627118644, 0.3305084745762712, 0.34745762711864403, 0.3432203389830508, 0.3347457627118644, 0.3347457627118644, 0.3432203389830508, 0.3305084745762712, 0.31779661016949157, 0.31779661016949157, 0.3432203389830508, 0.3347457627118644, 0.3093220338983051, 0.3220338983050848, 0.30508474576271183, 0.30508474576271183, 0.30508474576271183, 0.30508474576271183, 0.30932203389830504, 0.2966101694915254, 0.3008474576271186, 0.2966101694915254, 0.3008474576271186, 0.2966101694915254, 0.3008474576271186, 0.3220338983050848, 0.3093220338983051, 0.3093220338983051, 0.3093220338983051, 0.3008474576271186, 0.30932203389830504, 0.3220338983050847, 0.3135593220338983, 0.3177966101694915, 0.3177966101694915, 0.3177966101694915, 0.3220338983050847, 0.32627118644067793, 0.3177966101694915, 0.3177966101694915, 0.3177966101694915, 0.3177966101694915, 0.3177966101694915, 0.2966101694915254, 0.2923728813559322, 0.288135593220339, 0.3220338983050847, 0.3220338983050847, 0.2838983050847458, 0.2966101694915254, 0.2923728813559322, 0.2838983050847458, 0.2796610169491525, 0.2796610169491525, 0.2838983050847458, 0.2966101694915254, 0.288135593220339, 0.2838983050847458, 0.2838983050847458, 0.2838983050847458, 0.2838983050847458, 0.2754237288135593, 0.2838983050847458, 0.2838983050847458, 0.2838983050847458, 0.2838983050847458, 0.26694915254237284, 0.2754237288135593, 0.26694915254237284, 0.26694915254237284, 0.26694915254237284, 0.26694915254237284, 0.26694915254237284, 0.2754237288135593, 0.2711864406779661, 0.26694915254237284, 0.26694915254237284, 0.26694915254237284]
# m_1_prev =[0.4576271186440678, 0.9152542372881356, 0.9576271186440678, 0.9491525423728813, 0.9830508474576272, 0.9872881355932204, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9957627118644068, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9915254237288136, 0.9957627118644068, 1.0, 0.9957627118644067, 1.0, 0.9957627118644069, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9915254237288135, 0.9915254237288135, 0.9957627118644068, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288137, 0.9957627118644068, 1.0, 0.9957627118644067, 1.0, 0.9957627118644068, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 1.0, 1.0, 0.9957627118644068, 0.9957627118644069, 0.9957627118644069, 0.9957627118644067, 0.9957627118644067, 0.9957627118644068, 0.9957627118644068, 0.9957627118644069, 0.9957627118644069, 0.9957627118644067, 0.9957627118644068, 0.9957627118644068, 0.9915254237288136, 0.9957627118644067, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 1.0, 0.9957627118644068, 0.9957627118644068, 1.0, 1.0, 1.0, 0.9999999999999999, 0.9957627118644068, 0.9957627118644068, 0.9957627118644069, 0.9915254237288135, 0.9957627118644067, 0.9915254237288135, 1.0, 1.0, 0.9999999999999999, 0.9999999999999999, 1.0, 0.9957627118644068, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 0.9957627118644068, 0.9957627118644068, 0.9915254237288136, 0.9915254237288136, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9915254237288136, 0.9915254237288135, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 1.0, 1.0, 0.9957627118644068, 0.9957627118644068, 1.0, 1.0, 0.9957627118644068, 1.0, 0.9957627118644068, 1.0, 1.0, 1.0, 0.9957627118644068, 1.0, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9957627118644068, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136]
# m_2_prev =[0.3813559322033898, 0.8559322033898304, 0.864406779661017, 0.8220338983050847, 0.8432203389830509, 0.8855932203389831, 0.8855932203389831, 0.940677966101695, 0.9194915254237288, 0.9322033898305085, 0.940677966101695, 0.9406779661016949, 0.940677966101695, 0.9745762711864407, 0.961864406779661, 0.9745762711864407, 0.9788135593220338, 0.9830508474576272, 0.983050847457627, 0.9703389830508474, 0.9576271186440678, 0.9661016949152542, 0.9661016949152542, 0.9830508474576272, 0.9745762711864406, 0.9745762711864407, 0.978813559322034, 0.978813559322034, 0.9830508474576272, 0.9830508474576272, 0.983050847457627, 0.9830508474576272, 0.9830508474576272, 0.9830508474576272, 0.9830508474576272, 0.9830508474576272, 0.9830508474576272, 0.9830508474576272, 0.9830508474576272, 0.9830508474576272, 0.9830508474576272, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 1.0, 0.9872881355932203, 0.9915254237288136, 0.9830508474576272, 0.9830508474576272, 0.9872881355932203, 0.9872881355932203, 0.9872881355932204, 0.9915254237288135, 0.9872881355932204, 0.9915254237288137, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288135, 0.9830508474576272, 0.9872881355932204, 0.9915254237288136, 0.9915254237288137, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9872881355932204, 0.9872881355932203, 0.9872881355932204, 0.9872881355932203, 0.9872881355932204, 0.9915254237288135, 0.9915254237288135, 0.9915254237288135, 0.9872881355932204, 0.9872881355932205, 0.978813559322034, 0.9788135593220338, 0.9745762711864407, 0.9745762711864406]
#
# rp_1_mid =[0.4576271186440678, 0.9152542372881356, 0.9576271186440677, 0.9194915254237288, 0.940677966101695, 0.9661016949152543, 0.978813559322034, 0.9830508474576272, 0.9830508474576272, 0.978813559322034, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288137, 0.9915254237288135, 0.9957627118644068, 0.9957627118644068, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 0.9999999999999999, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
# rp_2_mid =[0.3813559322033898, 0.5635593220338982, 0.8135593220338984, 0.7923728813559321, 0.8008474576271186, 0.8389830508474576, 0.8389830508474576, 0.8898305084745763, 0.8686440677966102, 0.8728813559322035, 0.8728813559322034, 0.8813559322033898, 0.8728813559322035, 0.8813559322033898, 0.8771186440677966, 0.8813559322033899, 0.8898305084745763, 0.8898305084745763, 0.8898305084745763, 0.8644067796610169, 0.864406779661017, 0.8559322033898304, 0.8771186440677967, 0.8771186440677966, 0.8813559322033899, 0.8389830508474576, 0.7923728813559323, 0.8559322033898304, 0.8644067796610169, 0.8559322033898304, 0.864406779661017, 0.7245762711864406, 0.7330508474576272, 0.7669491525423728, 0.7161016949152542, 0.7457627118644068, 0.7754237288135593, 0.6313559322033899, 0.6567796610169492, 0.7033898305084746, 0.6779661016949152, 0.690677966101695, 0.7669491525423728, 0.6779661016949152, 0.728813559322034, 0.7245762711864407, 0.7966101694915255, 0.7838983050847458, 0.7966101694915254, 0.7076271186440678, 0.7245762711864407, 0.7457627118644068, 0.7457627118644068, 0.7415254237288136, 0.7457627118644068, 0.7245762711864407, 0.6440677966101696, 0.6864406779661016, 0.6991525423728814, 0.6822033898305084, 0.7161016949152542, 0.597457627118644, 0.5423728813559322, 0.6271186440677966, 0.614406779661017, 0.6906779661016949, 0.6949152542372882, 0.597457627118644, 0.5677966101694916, 0.5847457627118644, 0.576271186440678, 0.5550847457627119, 0.6271186440677966, 0.47457627118644063, 0.5296610169491525, 0.5805084745762712, 0.5508474576271187, 0.576271186440678, 0.5720338983050848, 0.4576271186440678, 0.4533898305084746, 0.4364406779661017, 0.4872881355932203, 0.4533898305084746, 0.5, 0.4279661016949152, 0.3898305084745763, 0.5127118644067796, 0.516949152542373, 0.5169491525423728, 0.5720338983050847, 0.521186440677966, 0.538135593220339, 0.559322033898305, 0.5593220338983051, 0.5423728813559322, 0.5423728813559322, 0.4449152542372881, 0.47881355932203395, 0.4491525423728814, 0.5, 0.5466101694915254, 0.5, 0.4745762711864407, 0.3940677966101695, 0.4152542372881356, 0.43220338983050843, 0.4491525423728813, 0.4322033898305085, 0.2457627118644068, 0.2584745762711865, 0.2923728813559322, 0.35593220338983056, 0.4364406779661017, 0.4067796610169492, 0.27118644067796616, 0.3220338983050848, 0.3305084745762712, 0.3305084745762712, 0.3135593220338983, 0.38983050847457623, 0.3771186440677966, 0.3771186440677966, 0.4576271186440678, 0.4194915254237288, 0.4661016949152542, 0.5169491525423728, 0.30508474576271183, 0.3940677966101695, 0.4025423728813559, 0.4322033898305085, 0.4915254237288136, 0.4830508474576271, 0.3813559322033898, 0.4194915254237288, 0.423728813559322, 0.4152542372881356, 0.4491525423728814, 0.5169491525423728, 0.4025423728813559, 0.4406779661016949, 0.5127118644067796, 0.5169491525423728, 0.4957627118644068, 0.5084745762711864, 0.423728813559322, 0.4067796610169492, 0.38983050847457623, 0.4025423728813559, 0.423728813559322]
# mp_1_mid =[0.0, 0.9449152542372882, 0.3771186440677966, 0.4110169491525424, 0.44067796610169496, 0.4576271186440678, 0.44491525423728817, 0.4364406779661017, 0.4279661016949152, 0.4322033898305085, 0.43220338983050843, 0.4279661016949152, 0.4152542372881356, 0.3898305084745763, 0.385593220338983, 0.364406779661017, 0.36016949152542377, 0.3474576271186441, 0.3474576271186441, 0.3474576271186441, 0.3432203389830508, 0.3432203389830508, 0.3432203389830508, 0.3389830508474576, 0.3516949152542373, 0.3559322033898305, 0.3559322033898305, 0.3516949152542373, 0.3432203389830508, 0.3432203389830508, 0.3432203389830508, 0.3516949152542373, 0.3432203389830508, 0.3516949152542373, 0.3559322033898305, 0.3559322033898305, 0.3559322033898305, 0.3559322033898305, 0.3516949152542373, 0.3516949152542373, 0.3601694915254237, 0.3601694915254237, 0.3559322033898305, 0.3686440677966102, 0.364406779661017, 0.364406779661017, 0.364406779661017, 0.3940677966101695, 0.4067796610169492, 0.4152542372881356, 0.4194915254237288, 0.423728813559322, 0.4194915254237288, 0.4194915254237288, 0.4194915254237288, 0.4194915254237288, 0.4194915254237288, 0.4194915254237288, 0.4152542372881356, 0.40254237288135597, 0.4067796610169492, 0.4110169491525424, 0.4110169491525424, 0.4110169491525424, 0.4067796610169492, 0.4067796610169492, 0.4152542372881356, 0.4152542372881356, 0.4110169491525424, 0.4110169491525424, 0.4110169491525424, 0.4110169491525424, 0.423728813559322, 0.4322033898305085, 0.4364406779661017, 0.4364406779661017, 0.4279661016949152, 0.4279661016949152, 0.4279661016949152, 0.4279661016949152, 0.4364406779661017, 0.4364406779661017, 0.4364406779661017, 0.4364406779661017, 0.43644067796610164, 0.4449152542372881, 0.4406779661016949, 0.4279661016949152, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.43644067796610164, 0.44067796610169485, 0.43644067796610164, 0.43644067796610164, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169485, 0.44067796610169496, 0.4364406779661017, 0.4364406779661017, 0.4364406779661017, 0.4364406779661017, 0.4364406779661017, 0.43220338983050843, 0.44067796610169485, 0.44067796610169485, 0.44491525423728817, 0.44491525423728817, 0.4364406779661017, 0.44491525423728817, 0.44491525423728817, 0.44491525423728817, 0.44491525423728817, 0.4491525423728814, 0.44491525423728817, 0.44491525423728817, 0.44491525423728817, 0.44491525423728817, 0.44491525423728817, 0.44491525423728817, 0.4406779661016949, 0.44491525423728817, 0.4533898305084746, 0.4533898305084746, 0.4533898305084746, 0.44491525423728817]
# mp_2_mid =[0.0, 0.9067796610169491, 0.2838983050847458, 0.3305084745762712, 0.3771186440677966, 0.4067796610169492, 0.4788135593220339, 0.5042372881355932, 0.5169491525423728, 0.5169491525423728, 0.538135593220339, 0.4449152542372881, 0.3940677966101695, 0.3644067796610169, 0.3347457627118644, 0.326271186440678, 0.3305084745762712, 0.3305084745762712, 0.3305084745762712, 0.3305084745762712, 0.326271186440678, 0.3305084745762712, 0.326271186440678, 0.31779661016949157, 0.326271186440678, 0.3305084745762712, 0.30932203389830515, 0.3093220338983051, 0.3093220338983051, 0.3135593220338983, 0.3220338983050848, 0.3220338983050848, 0.3093220338983051, 0.3093220338983051, 0.31779661016949157, 0.30932203389830515, 0.31355932203389836, 0.3220338983050848, 0.3008474576271186, 0.2966101694915254, 0.3093220338983051, 0.3093220338983051, 0.3093220338983051, 0.2923728813559322, 0.2923728813559322, 0.2923728813559322, 0.3008474576271186, 0.2966101694915254, 0.288135593220339, 0.2966101694915254, 0.3093220338983051, 0.3093220338983051, 0.2966101694915254, 0.288135593220339, 0.2966101694915254, 0.2966101694915254, 0.288135593220339, 0.2966101694915254, 0.2923728813559322, 0.2966101694915254, 0.3093220338983051, 0.31779661016949157, 0.31779661016949157, 0.3220338983050848, 0.3220338983050848, 0.3220338983050848, 0.3220338983050848, 0.3220338983050848, 0.3389830508474576, 0.3389830508474576, 0.3389830508474576, 0.3305084745762712, 0.3389830508474576, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.35593220338983056, 0.35593220338983056, 0.35593220338983056, 0.35593220338983056, 0.35593220338983056, 0.35593220338983056, 0.35593220338983056, 0.3516949152542373, 0.3474576271186441, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3474576271186441, 0.3474576271186441, 0.3474576271186441, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3559322033898305, 0.3559322033898305, 0.3559322033898305, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3516949152542373, 0.3559322033898305, 0.3559322033898305, 0.3686440677966102, 0.3686440677966102, 0.364406779661017, 0.3601694915254237, 0.364406779661017, 0.3601694915254237, 0.3601694915254237, 0.3601694915254237, 0.3601694915254237, 0.3601694915254237, 0.3559322033898305, 0.3601694915254237, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.364406779661017, 0.364406779661017, 0.3601694915254237, 0.3601694915254237, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.3686440677966102, 0.364406779661017, 0.364406779661017, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.36016949152542377, 0.3559322033898305, 0.36016949152542377, 0.36016949152542377, 0.3686440677966102, 0.3686440677966102, 0.3686440677966102, 0.3686440677966102]
# m_1_mid =[0.4576271186440678, 0.9152542372881356, 0.9576271186440678, 0.9491525423728814, 0.9830508474576272, 0.983050847457627, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9957627118644068, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9957627118644068, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9957627118644068, 0.9957627118644067, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9957627118644068, 0.9957627118644068, 0.9915254237288136, 0.9957627118644068, 1.0, 0.9957627118644068, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 0.9999999999999999, 1.0, 1.0, 1.0, 0.9999999999999999, 0.9999999999999999, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999999999999, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
# m_2_mid =[0.3813559322033898, 0.8559322033898304, 0.8559322033898306, 0.8050847457627118, 0.826271186440678, 0.8771186440677965, 0.8728813559322035, 0.9194915254237288, 0.9067796610169492, 0.9152542372881356, 0.9279661016949152, 0.9279661016949152, 0.9279661016949152, 0.9533898305084745, 0.9322033898305084, 0.9618644067796611, 0.9661016949152543, 0.9661016949152542, 0.9788135593220338, 0.9576271186440678, 0.940677966101695, 0.9322033898305085, 0.940677966101695, 0.9576271186440678, 0.9576271186440677, 0.9576271186440678, 0.9449152542372882, 0.9322033898305085, 0.9406779661016949, 0.9533898305084745, 0.9533898305084746, 0.9194915254237288, 0.9364406779661016, 0.9449152542372881, 0.9322033898305085, 0.940677966101695, 0.9406779661016949, 0.9194915254237288, 0.923728813559322, 0.9110169491525424, 0.9152542372881356, 0.9152542372881356, 0.923728813559322, 0.9364406779661016, 0.9322033898305084, 0.940677966101695, 0.9449152542372882, 0.9491525423728814, 0.9491525423728815, 0.9491525423728814, 0.9449152542372882, 0.9491525423728814, 0.9533898305084746, 0.9491525423728813, 0.9533898305084746, 0.9576271186440677, 0.9576271186440679, 0.9533898305084745, 0.9576271186440678, 0.9576271186440678, 0.9576271186440678, 0.9576271186440678, 0.9576271186440678, 0.9576271186440677, 0.9576271186440679, 0.9576271186440678, 0.961864406779661, 0.9576271186440677, 0.9576271186440679, 0.9576271186440678, 0.9576271186440678, 0.9661016949152542, 0.9703389830508474, 0.9576271186440678, 0.9576271186440677, 0.9745762711864407, 0.9745762711864407, 0.9745762711864406, 0.9830508474576272, 0.9661016949152542, 0.9745762711864406, 0.9745762711864406, 0.9745762711864407, 0.978813559322034, 0.9830508474576272, 0.9745762711864407, 0.9788135593220338, 0.9830508474576272, 0.983050847457627, 0.983050847457627, 0.983050847457627, 0.983050847457627, 0.9830508474576272, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9830508474576272, 0.9830508474576272, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288135, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136, 0.9915254237288137, 0.9915254237288137, 0.9915254237288136, 0.9915254237288136, 0.9915254237288136]
#
#
# print(max(rp_1_prev), max(m_1_prev), max(rp_1_mid), max(m_1_mid))
# colors = dict(mcolors.BASE_COLORS, **mcolors.CSS4_COLORS)
# x = range(0,300,2)
# plt.plot(x,rp_1_prev, label= "RP max previous", color=colors["k"])
# # plt.plot(x,rp_2_prev, label = "RP diff previous", color=colors["r"])
# # plt.plot(x,mp_1_prev, label = "Mean prime max previous", color= colors["chocolate"])
# # plt.plot(x,mp_2_prev, label= "Mean prime diff previous", color = colors["darkorange"])
# plt.plot(x,m_1_prev, label = "Mean max previous", color = colors["turquoise"])
# # plt.plot(x,m_2_prev, label= "Mean diff previous", color= colors["yellow"])
# plt.plot(x,rp_1_mid, label= "RP max middle", color = colors["forestgreen"])
# # plt.plot(x,rp_2_mid, label = "RP diff middle", color = colors["gold"])
# # plt.plot(x,mp_1_mid, label = "Mean prime max middle", color = colors["deepskyblue"])
# # plt.plot(x,mp_2_mid, label= "Mean prime diff middle", color = colors["b"])
# plt.plot(x,m_1_mid, label = "Mean max middle", color = colors["m"])
# # plt.plot(x,m_2_mid, label= "Mean diff middle", color = colors["slategrey"])
# plt.title("AUC for different window length and methods")
# plt.xlabel("Window length")
# plt.ylabel("AUC")
# plt.legend()
# plt.show()

from scipy.io import arff
import pandas as pd
# from sklearn.preprocessing import StandardScaler
#
# # normalise different components of the time series.
# def normalise(signal):
#     # centering and scaling happens independently on each signal
#     scaler = StandardScaler()
#     return scaler.fit_transform(signal)


# data = arff.loadarff("C:/Users/carol/Downloads/EEG-Eye-State.arff")
# df = pd.DataFrame(data[0])
# df['eyeDetection'] = pd.to_numeric(df['eyeDetection'])
# values = df.values
# for i in range(values.shape[1] - 1):
# 	# calculate column mean and standard deviation
# 	data_mean, data_std = np.mean(values[:,i]), np.std(values[:,i])
# 	# define outlier bounds
# 	cut_off = data_std * 10
# 	lower, upper = data_mean - cut_off, data_mean + cut_off
# 	# remove too small
# 	too_small = [j for j in range(values.shape[0]) if values[j,i] < lower]
# 	values = np.delete(values, too_small, 0)
# 	print('>deleted %d rows' % len(too_small))
# 	# remove too large
# 	too_large = [j for j in range(values.shape[0]) if values[j,i] > upper]
# 	values = np.delete(values, too_large, 0)
# 	print('>deleted %d rows' % len(too_large))
# # save the results to a new file
# np.savetxt('EEG_Eye_State_no_outliers.csv', values, delimiter=',', header=",".join(list(df.columns)))
# data = pd.read_csv('EEG_Eye_State_no_outliers.csv')
# # retrieve data as numpy array
#
# values = data.values
# print(data.head())
# # create a subplot for each time series
# plt.figure()
# plt.title("")
# for i in range(values.shape[1]-1):
# 	plt.subplot(values.shape[1], 1, i+1)
# 	plt.plot(values[:3500, i])
# 	plt.ylabel(data.columns[i])
# plt.subplot(values.shape[1], 1, values.shape[1])
# plt.bar(range(3500),values[:3500, values.shape[1]-1])
# plt.ylabel("Label")
# plt.show()

# fig, axs = plt.subplots(4, 1, gridspec_kw={'height_ratios': [1, 1,1, 1]})
#
#
# axs[0].plot(range(3500),df["AF3"][:3500])
# axs[1].plot(range(3500),df["F7"][:3500])
# axs[2].plot(range(3500),df["FC5"][:3500])
#
# axs[3].bar(range(3500), df["eyeDetection"][:3500])
# plt.show()

# x = [[1,2,3,4],[2,3,4,5],[1,2,3,4]]
# for c in [0,1,2,3]:
#     scores_per_point = [i[c] for i in x]
#     print(scores_per_point)
#     up = np.quantile(scores_per_point, 0.99)
#     low = np.quantile(scores_per_point, 0.01)
#     print(max(up, 1-low))
# name = "ambient_temperature_system_failure"
# data, labels = nab.load_data(f"realKnownCause/{name}.csv", False)
# data, labels, to_add_times, to_add_values = nab.clean_data(data, labels, name=name, unit = [0,1], plot=False)

# data_diff = data['value'].diff()
# data_diff_left = data['value'].diff(-1)
# data_diff = [np.abs(i) for i in data_diff]
# data_diff_left = [np.abs(i) for i in data_diff_left]
# print(data['value'])
# # print(data_diff)
# print(data_diff_left)
# plt.plot(data_diff)
# plt.show()
# max_diff = data_diff.max()
# print(max_diff)
# print(data_diff[data_diff== max_diff].index.values)
#
# min_diff = data_diff.min()
# print(min_diff)
# print(data_diff[data_diff == min_diff].index.values)
# print(data['value'].iloc[812],data['value'].iloc[813])
# print(data_diff[810], data_diff[811], data_diff[812], data_diff[813], data_diff[814], data_diff[815])

# vec1 = np.asarray([1,2,3,4,5,1,2])
# fig, ax = plt.subplots(3,1, figsize=(14,5), gridspec_kw={'height_ratios':[2,2,0.25]})
# ax[0].plot([1,2,3,4,5,1,2])
# ax[0].set_xlim([0,len(vec1)-1])
# # print(data['timestamp'])
# print(min(data['timestamp']), max(data['timestamp']))
#
# seaborn.heatmap([vec1],  annot=[['o', 't', 'th', 'f', 'f', 'o', 't']], fmt='', ax=ax[1], cbar_ax=ax[2],cbar_kws={"orientation": "horizontal"})
# # plt.show()

# map_object = map(scipy.stats.percentileofscore, vec1)

# new_list = np.array(list(map(lambda v:scipy.stats.percentileofscore(vec1,v), vec1 )))
# print(scipy.stats.percentileofscore(vec1))
# print(new_list)


# win_length_range = np.unique(np.logspace(0, np.log(600), 50, dtype=int, base=np.e))
# print(win_length_range)
# from numba import jit
# import numpy as np
#
# @jit(nopython=True)
# def func(x):
#     score= np.linalg.norm(np.array([x,x]) - np.array([1.0,1.0])) ** 2
#     return score
#
# @jit(nopython=True)
# def func_1(win_pos, k, win_length, data):
#     if win_pos == 'mid':
#         R = np.random.normal(loc=0.0, scale=1.0, size=(k, win_length+1))
#     else:
#         R = np.random.normal(loc=0.0, scale=1.0, size=(k, win_length + 1))
#     scores = np.array([0 for _ in range(len(data))])
#     for i in range(len(data)):
#         x = [i,i]
#         scores[i] = func(x)
#     return scores
#
#
# data = np.array([1,1,1,1,1,1,1])
# func_1('mid',1,2,data)
# print(data[1])
# print(data[1:2])
# import load_data_MITBIH as mb
# from sklearn.preprocessing import StandardScaler
#
# def normalise(signal):
#     # centering and scaling happens independently on each signal
#     scaler = StandardScaler()
#     return scaler.fit_transform(signal)
#
#
# record, annotation = mb.load_mit_bih_data("100", 0, None)
# signal_norm, heart_beats, heart_beats_x, labels = mb.label_clean_q_points_single(record, annotation, 0, None)
# timestamp = np.array([int(i) for i in range(len(signal_norm))])
# signal = pd.DataFrame(signal_norm, columns=record.sig_name, index=timestamp)
# signal = normalise(signal.values)
# print(signal[1].reshape(1,-1).shape)
# print(signal[0:4].shape)
# import random
# print(np.unique(np.logspace(0, np.log(800), 50, dtype=int, base=np.e)))
import load_data_MITBIH as mb
from numba import jit

# @jit(nopython=True)
# def mean_columns(point):
#     means = []
#     for c in range(len(point[0])):
#         column = point[:, c]
#         means.append(np.mean(column))
#
#     return np.array(means)
#
#
# @jit(nopython=True)
# def compute_score(signal):
#     outlier_scores = np.array([0.0 for _ in range(len(signal))])
#     for i in range(0, len(signal)):
#         previous = i - 10 // 2
#         future = i + 10 // 2
#         if previous < 0:
#             previous = 0
#         if future > len(signal) - 1:
#             future = len(signal) - 1
#         point = np.concatenate((signal[previous:i], signal[i + 1:future + 1]))
#         mean = mean_columns(point)
#         score = np.linalg.norm(signal[i] - mean) ** 2
#         outlier_scores[i] = score
#
#     # normalise
#     if max(outlier_scores) != 0:
#         outlier_scores = outlier_scores * (1 / max(outlier_scores))
#
#     return outlier_scores
#
# record, annotation = mb.load_mit_bih_data("100", 0, 3000)
# signal_norm, heart_beats, heart_beats_x, labels = mb.label_clean_q_points_single(record, annotation, 0, 3000)
# timestamp = np.array([int(i) for i in range(len(signal_norm))])
# signal = pd.DataFrame(signal_norm, columns=record.sig_name, index=timestamp).values
# score = compute_score(signal)

import scipy as sc
import random
import numpy as np
import random
from numba import jit
import pandas as pd
from sklearn.preprocessing import StandardScaler
import sklearn.model_selection as sm
import scipy as sc
from tqdm import tqdm
from concurrent.futures import ProcessPoolExecutor,ThreadPoolExecutor, as_completed
import argparse
from itertools import repeat
from functools import partial

import load_data_NAB as nab
import plot_curves as pc
import load_data_MITBIH as mb




@jit(nopython=True)
def standardise_scores_z_score(scores):
    return (scores - np.mean(scores))/np.std(scores)


def normalise(signal):
    # centering and scaling happens independently on each signal
    scaler = StandardScaler()
    return scaler.fit_transform(signal)

@jit(nopython=True)
def mean_columns(point):
    means = []
    for c in range(len(point[0])):
        column = point[:, c]
        means.append(np.mean(column))

    return np.array(means)


@jit(nopython=True)
def mean_prime(signal, norm_power, win_length):
    outlier_scores = np.array([0.0 for _ in range(len(signal))])
    for i in range(0, len(signal)):
        previous = i - win_length // 2
        future = i + win_length // 2
        if previous < 0:
            previous = 0
        if future > len(signal) - 1:
            future = len(signal) - 1
        point = np.concatenate((signal[previous:i], signal[i + 1:future + 1]))
        print(point)
        mean = mean_columns(point)
        score = np.linalg.norm(signal[i] - mean) ** norm_power
        print(score)
        outlier_scores[i] = score

    return standardise_scores_z_score(outlier_scores)


@jit(nopython=True)
def random_projection_single(point, k, norm_perservation, norm_power, R):
    d = R.shape[1]
    # If window smaller than d
    if len(point) < d:
        R_prime = R[:, :len(point)]
        point_proj = (1 / np.sqrt(d) * R_prime) @ point
        point_reconstruct = (1 / np.sqrt(d) * R_prime.T) @ point_proj
    else:
        point_proj = (1 / np.sqrt(d) * R) @ point
        point_reconstruct = (1 / np.sqrt(d) * R.T) @ point_proj

    if norm_perservation:
        point_reconstruct = np.sqrt(d / k) * point_reconstruct

    outlier_score = np.linalg.norm(point - point_reconstruct) ** norm_power

    return outlier_score


@jit(nopython=True)
def random_projection_window(data, k, norm_perservation, win_pos, norm_power, win_length):
    # Parameters of random projection + window method.
    if win_pos == 'mid' and win_length != 1:
        R = np.random.normal(loc=0.0, scale=1.0, size=(k, win_length+1))
    else:
        R = np.random.normal(loc=0.0, scale=1.0, size=(k, win_length))

    outlier_scores = np.array([0.0 for _ in range(len(data))])
    for i in range(len(data)):
        if win_length == 1:
            point = data[i].reshape(1,-1)
        else:
            if win_pos == 'prev':
                previous = i - win_length + 1
                future = i
            elif win_pos == "mid":
                previous = i - win_length // 2
                future = i + win_length // 2
            else:
                previous = i
                future = i + win_length - 1

            if previous < 0:
                previous = 0
            if future >= len(data):
                future = len(data) - 1

            point = data[previous:future + 1]
        print(point)
        outlier_scores[i] = random_projection_single(point, k, norm_perservation, norm_power, R)
    return standardise_scores_z_score(outlier_scores)

# data = np.array([1.0,2,3,4,5,6,7,8]).reshape(-1,1)
# random_projection_window(data, 2,True, '', 2, 3)

def summarise_scores_supervised(all_scores, labels):
    train_indices = np.array([i for i in range(len(labels))]).reshape(-1, 1)
    X_train_i, X_test_i, y_train, y_test = sm.train_test_split(train_indices, labels,  test_size = 0.2, stratify=labels)

    scores_binary = np.full(all_scores.shape, 0)
    for i, scores in enumerate(all_scores):
        scores_binary[i] = np.array((np.where((scores > 1.96) | (scores <-1.96), 1, 0)))

    scores_train = scores_binary[:, X_train_i].reshape(scores_binary.shape[0],-1)
    scores_test = scores_binary[:, X_test_i].reshape(scores_binary.shape[0],-1)

    w = np.ones(scores_train.shape[0])
    weighted_scores_binary_train = np.full(y_train, 0)

    while not np.array_equal(weighted_scores_binary_train, y_train):
        for i,score in enumerate(weighted_scores_binary_train):
            if score == 0 and y_train[i] == 1:
                for j, s in enumerate(scores_train[:,i]):
                    if s == 1:
                        w[j] = w[j]*2
            if score == 1 and y_train[i] == 0:
                for j,s in enumerate(scores_train[:,i]):
                    if s == 1:
                        w[j] = w[j]/2
        weighted_scores_train = (w.reshape(1, -1) @ scores_train)[0]
        weighted_scores_binary_train = np.array(np.where(weighted_scores_train > all_scores.shape[0], 1, 0))
    predict_test = np.array(np.where((w.reshape(1,-1) @ scores_test)[0] > all_scores.shape[0], 1, 0))
    return predict_test, y_test


import sklearn.model_selection as sk


def summarise_scores_supervised_scores_corr_m(all_scores, labels):
    train_indices = np.array([i for i in range(len(labels))]).reshape(-1, 1)
    X_train_i, X_test_i, y_train, y_test = sk.train_test_split(train_indices, labels, test_size=0.2, stratify=labels)

    scores_train = all_scores[:, X_train_i].reshape(all_scores.shape[0], -1)
    scores_test = all_scores[:, X_test_i].reshape(all_scores.shape[0], -1)

    del all_scores, train_indices, labels

    w = np.ones(scores_train.shape[0])

    y_train = np.array(y_train)

    corr_old = 0
    corr_new = 1

    while not np.abs(corr_new - corr_old) < 0.0000001:
        for m in range(scores_train.shape[0]):
            if abs(np.corrcoef(scores_train[m], y_train)[0,1]) > 0.55:
                w[m] = w[m] * 2
            else:
                w[m] = w[m] / 2

        weighted_scores_train = (w.reshape(1, -1) @ scores_train)[0]
        corr_old = corr_new
        corr_new = np.corrcoef(weighted_scores_train, y_train)[0, 1]
    predict_test = np.array((w.reshape(1, -1) @ scores_test)[0])
    flip = False

    if corr_new < 0:
        flip = True
    return predict_test, y_test, flip

import scipy.stats as ss
all_scores = np.array([[-2, 1, 3, 0, 0, 0.5],[0, 1, 0, 0, 0, 0.5], [-4, 2, 5, 2, 2, 3]])
labels = np.array([1,0,1,0,0,0])
print(summarise_scores_supervised_scores_corr_m(all_scores, labels))
